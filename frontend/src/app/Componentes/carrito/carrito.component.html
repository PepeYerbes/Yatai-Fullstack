<div class="container mt-4">
    <h2 class="mb-4">Tu Carrito de Compras</h2>
    
    @if (cartItems.length === 0) {
      <div class="alert alert-info">
        <i class="bi bi-cart-x"></i> Tu carrito está vacío
        <button class="btn btn-outline-primary ms-3" (click)="continueShopping()">
          Ir a comprar
        </button>
      </div>
    }
  
    @if (cartItems.length > 0) {
      <div class="table-responsive">
        <table class="table">
          <thead class="table-light">
            <tr>
              <th>Producto</th>
              <th>Precio</th>
              <th>Cantidad</th>
              <th>Total</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            @for (item of cartItems; track item.product.id) {
              <tr>
                <td>
                  <div class="d-flex align-items-center">
                    <img 
                      [src]="item.product.imagenUrl" 
                      [alt]="item.product.name"
                      class="img-thumbnail me-3"
                      style="width: 80px; height: 80px; object-fit: contain;">
                    <div>
                      <h6 class="mb-1">{{ item.product.name }}</h6>
                      <small class="text-muted">{{ item.product.category }}</small>
                    </div>
                  </div>
                </td>
                <td class="align-middle">{{ item.product.price | currency }}</td>
                <td class="align-middle">
                  <input 
                    type="number" 
                    class="form-control" 
                    style="width: 80px;"
                    min="1" 
                    [max]="item.product.stock"
                    [value]="item.quantity"
                    (change)="updateQuantity(item.product.id, $event)">
                </td>
                <td class="align-middle">{{ item.product.price * item.quantity | currency }}</td>
                <td class="align-middle">
                  <button 
                    class="btn btn-danger btn-sm"
                    (click)="removeItem(item.product.id)"
                    title="Eliminar">
                    <i class="bi bi-trash"></i>
                  </button>
                </td>
              </tr>
            }
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3" class="text-end"><strong>Total:</strong></td>
              <td colspan="2">{{ total | currency }}</td>
            </tr>
          </tfoot>
        </table>
      </div>
  
      <div class="d-flex justify-content-between mt-4">
        <button class="btn btn-outline-secondary" (click)="continueShopping()">
          <i class="bi bi-arrow-left"></i> Seguir comprando
        </button>
        <button class="btn btn-primary" (click)="proceedToCheckout()">
          Proceder al pago <i class="bi bi-arrow-right"></i>
        </button>
      </div>
    }
  </div>